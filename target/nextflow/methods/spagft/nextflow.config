manifest {
  name = 'methods/spagft'
  mainScript = 'main.nf'
  nextflowVersion = '!>=20.12.1-edge'
  version = 'build_main'
  description = 'The tissue module (TM) was defined as an architectural area containing recurrent cellular \ncommunities executing specific biological functions at different tissue sites. \nHowever, the computational identification of TMs poses challenges owing to their various \nlength scales, convoluted biological processes, not well-defined molecular features, and \nirregular spatial patterns. Here, we present a hypothesis-free graph Fourier transform model, \nSpaGFT, to characterize TMs. For the first time, SpaGFT transforms complex gene expression \npatterns into simple, but informative signals, leading to the accurate identification of \nspatially variable genes (SVGs) at a fast computational speed. Based on clustering the \ntransformed signals of the SVGs, SpaGFT provides a novel computational framework for TM \ncharacterization. Three case studies were used to illustrate TM identities, the biological \nprocesses of convoluted TMs in the lymph node, and conserved TMs across multiple samples constituting \nthe complex organ. The superior accuracy, scalability, and interpretability of SpaGFT indicate \nthat it is a novel and powerful tool for the investigation of TMs to gain new insights into a variety \nof biological questions.\n'
}

process.container = 'nextflow/bash:latest'

// detect tempdir
tempDir = java.nio.file.Paths.get(
  System.getenv('NXF_TEMP') ?:
    System.getenv('VIASH_TEMP') ?: 
    System.getenv('TEMPDIR') ?: 
    System.getenv('TMPDIR') ?: 
    '/tmp'
).toAbsolutePath()

profiles {
  no_publish {
    process {
      withName: '.*' {
        publishDir = [
          enabled: false
        ]
      }
    }
  }
  mount_temp {
    docker.temp            = tempDir
    podman.temp            = tempDir
    charliecloud.temp      = tempDir
  }
  docker {
    docker.enabled         = true
    // docker.userEmulation   = true
    singularity.enabled    = false
    podman.enabled         = false
    shifter.enabled        = false
    charliecloud.enabled   = false
  }
  singularity {
    singularity.enabled    = true
    singularity.autoMounts = true
    docker.enabled         = false
    podman.enabled         = false
    shifter.enabled        = false
    charliecloud.enabled   = false
  }
  podman {
    podman.enabled         = true
    docker.enabled         = false
    singularity.enabled    = false
    shifter.enabled        = false
    charliecloud.enabled   = false
  }
  shifter {
    shifter.enabled        = true
    docker.enabled         = false
    singularity.enabled    = false
    podman.enabled         = false
    charliecloud.enabled   = false
  }
  charliecloud {
    charliecloud.enabled   = true
    docker.enabled         = false
    singularity.enabled    = false
    podman.enabled         = false
    shifter.enabled        = false
  }
}

process{
  withLabel: lowmem { memory = 20.Gb }
  withLabel: midmem { memory = 50.Gb }
  withLabel: highmem { memory = 100.Gb }
  withLabel: lowcpu { cpus = 5 }
  withLabel: midcpu { cpus = 15 }
  withLabel: highcpu { cpus = 30 }
  withLabel: lowtime { time = 1.h }
  withLabel: midtime { time = 4.h }
  withLabel: hightime { time = 8.h }
  withLabel: veryhightime { time = 24.h }
}

process.errorStrategy = 'ignore'
